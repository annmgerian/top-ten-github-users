{"ast":null,"code":"import _Object$assign from \"@babel/runtime-corejs2/core-js/object/assign\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/home/ann/Development/Projects/Work/agile-nix-test/front/components/Users.js\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faMapMarkerAlt, faEnvelope, faStar, faSpinner } from '@fortawesome/free-solid-svg-icons';\nimport styled, { css } from 'styled-components';\nimport axios from 'axios';\nimport { connect } from 'react-redux';\nimport { addSum, addData } from '../redux/actions/index';\n\nconst sumStateToProps = state => {\n  return {\n    sum: state.sum\n  };\n};\n\nconst dataStateToProps = state => {\n  return {\n    data: state.data\n  };\n};\n\nfunction sumDispatchToProps(dispatch) {\n  return {\n    addSum: sum => dispatch(addSum(sum))\n  };\n}\n\nfunction dataDispatchToProps(dispatch) {\n  return {\n    addData: data => dispatch(addData(data))\n  };\n}\n\nconst axiosGitHubGraphQL = axios.create({\n  baseURL: 'https://api.github.com/graphql',\n  headers: {\n    Authorization: 'bearer 2cdc2aa829e6a0fe455edaf962cdda54e923b505'\n  }\n});\nconst GET_RATE = `\n{\n    search(   \n      type: USER, query:\"location:Kharkiv sort:followers-desc\"\n      first: 10) {\n      nodes {\n        ... on User {\n          name\n          login\n          avatarUrl\n          url\n          bio\n          location\n          email\n          repositories{totalCount}\n          topRepositories(first: 100, orderBy:{field: STARGAZERS, direction: DESC}) {\n            edges {\n              node {\n                stargazers{totalCount}\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n`;\nconst Divider = styled.hr`\n    background: rgba(128, 128, 128, 0.5);\n    width: 700px;\n    margin-left: auto;\n    margin-right: auto;\n    height: 1px;\n    border: 0;\n`;\nconst Avatar = styled.img`\n    width: 75px;\n    margin-top: 10px;\n    border-radius: 10px;\n    margin-bottom: 10px;\n`;\nconst Info = styled.div`\n    display: flex;\n    width: 88%;\n    flex-flow: column;\n    margin-top: 10px;\n`;\nconst Login = styled.div`\n    width: 88%;\n    display: flex;\n`;\nconst Status = styled.div`\n    margin-top: 10px;\n    padding-left: 10px;\n`;\nconst Link = styled.a`\n    text-decoration: blink;\n    padding-left: 10px;\n    color: #2664d9;\n`;\nconst Name = styled.p`\n    padding-left: 10px;\n    margin: 0;\n`;\nconst Icons = styled.div`\n    display: flex;\n    margin-top: 10px;\n    color: #858585;\n`;\nconst LocationIcon = styled.div`\n    padding-left: 10px;\n`;\nconst MailIcon = styled.div`\n    padding-left: 40px;\n`;\nconst StarIcon = styled.div`\n    padding-left: 40px;\n`;\nconst Stars = styled.div`\n    padding-left: 10px;\n`;\nconst Location = styled.div`\n    padding-left: 10px;\n`;\nconst MailAdress = styled.div`\n    padding-left: 10px;\n`;\nconst Block = styled.div`\n    width: 700px;\n    margin-left: auto;\n    margin-right: auto;\n    display: flex;\n`;\nconst Loading = styled.div`\n    display: flex;\n    align-items: center;\n    height: 100vh;\n    justify-content: center;\n`;\n\nclass ConnectedUsers extends React.Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"GET_SUM_FIRST_HUNDRED\", login => `query \n{\n  search(   \n    type: USER, query:\"user:${login}\"\n    first: 1) {\n    nodes {\n      ... on User {\n        login\n        repositories (first:100) {\n      pageInfo {\n        hasNextPage,\n        endCursor\n      },\n      nodes {\n        stargazers{totalCount}\n      }\n      }\n    }\n  }\n}\n}`);\n\n    _defineProperty(this, \"GET_SUM_HUNDRED\", (login, after) => `query \n{\n  search(   \n    type: USER, query:\"user:${login}\"\n    first: 1) {\n    nodes {\n      ... on User {\n        login\n        repositories (first:100, after:\"${after}\") {\n      pageInfo {\n        hasNextPage,\n        endCursor\n      },\n      nodes {\n        stargazers{totalCount}\n      }\n      }\n    }\n  }\n}\n}`);\n\n    _defineProperty(this, \"onFetchSumHundredFromGitHub\", (user, number, endCursor) => {\n      const that = this;\n      const after = endCursor.toString();\n      const login = user;\n      const key = number;\n      axiosGitHubGraphQL.post('', {\n        query: that.GET_SUM_HUNDRED(login, after)\n      }).then(result => {\n        let array = result.data.data.search.nodes[0].repositories;\n        that.getSumHundred(array, key);\n      });\n    });\n\n    _defineProperty(this, \"onFetchSumForFirstHundredFromGitHub\", (user, number) => {\n      const that = this;\n      const login = user;\n      const key = number;\n      axiosGitHubGraphQL.post('', {\n        query: that.GET_SUM_FIRST_HUNDRED(login)\n      }).then(result => {\n        let array = result.data.data.search.nodes[0].repositories;\n        that.getSumFirstHundred(array, key, login);\n      });\n    });\n\n    _defineProperty(this, \"onFetchFromGitHub\", () => {\n      const that = this;\n      const {\n        data\n      } = this.props;\n      axiosGitHubGraphQL.post('', {\n        query: GET_RATE\n      }).then(result => {\n        let array = result.data.data.search.nodes;\n\n        for (var i = 0; i < 10; i++) {\n          data.push({\n            avatarUrl: array[i].avatarUrl,\n            bio: array[i].bio,\n            email: array[i].email,\n            location: array[i].location,\n            login: array[i].login,\n            name: array[i].name,\n            url: array[i].url\n          });\n          this.props.addData({\n            data: data\n          }); // that.setState({ data: data });\n\n          if (array[i].repositories.totalCount > 100) {\n            that.onFetchSumForFirstHundredFromGitHub(array[i].login, i);\n          } else {\n            that.getSum(array[i].topRepositories.edges, i);\n          }\n        }\n      }).catch(function (error) {\n        alert(error);\n      });\n    });\n\n    this.state = {// externalData: null\n      // sum: {},\n      // data: []\n    };\n    this.getSum = this.getSum.bind(this);\n  } // componentWillMount() {\n  //     this._asyncRequest = this.onFetchFromGitHub().then(externalData => {\n  //         this._asyncRequest = null;\n  //         this.setState({ externalData });\n  //     });\n  // }\n\n\n  componentDidMount() {\n    this.onFetchFromGitHub();\n  }\n\n  getSumHundred(array, number, name) {\n    let key = number;\n    let summ = 0;\n    const login = name;\n    const {\n      sum\n    } = this.props;\n    array.nodes.forEach(element => {\n      summ += element.stargazers.totalCount;\n    });\n    this.props.addSum({\n      sum: _Object$assign(sum, {\n        [key]: summ + sum[key]\n      })\n    }); // this.setState({\n    //     sum: Object.assign(this.state.sum, {\n    //         [key]: sum + this.state.sum[key]\n    //     })\n    // });\n  }\n\n  getSumFirstHundred(array, number, name) {\n    let key = number;\n    let summ = 0;\n    const {\n      sum\n    } = this.props;\n    const login = name;\n    array.nodes.forEach(element => {\n      summ += element.stargazers.totalCount;\n    });\n    this.props.addSum({\n      sum: _Object$assign(sum, {\n        [key]: summ\n      })\n    }); // this.setState({ sum: Object.assign(this.state.sum, { [key]: sum }) });\n\n    if (array.pageInfo.hasNextPage === true) {\n      this.onFetchSumHundredFromGitHub(login, key, array.pageInfo.endCursor);\n    }\n  }\n\n  getSum(array, number) {\n    let key = number;\n    let summ = 0;\n    const {\n      sum\n    } = this.props;\n\n    if (array !== undefined) {\n      array.forEach(element => {\n        summ += element.node.stargazers.totalCount;\n      });\n    }\n\n    this.props.addSum({\n      sum: _Object$assign(sum, {\n        [key]: summ\n      })\n    }); // this.setState({ sum: Object.assign(this.state.sum, { [key]: sum }) });\n  }\n\n  render() {\n    // if (this.state.externalData === null) {\n    //     // Render loading state ...\n    //     console.log(0);\n    // } else {\n    const {\n      data,\n      sum\n    } = this.props;\n    console.log(data);\n    return __jsx(React.Fragment, null, // data.length === 0\n    // false ? (\n    //     <Loading>\n    //         <FontAwesomeIcon\n    //             icon={faSpinner}\n    //             size=\"4x\"\n    //             spin\n    //             pulse\n    //         />\n    //     </Loading>\n    // ) : (\n    __jsx(React.Fragment, null, __jsx(Divider, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 364\n      },\n      __self: this\n    }), data.map(user => __jsx(React.Fragment, null, __jsx(Block, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 368\n      },\n      __self: this\n    }, __jsx(Avatar, {\n      src: user.avatarUrl,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 369\n      },\n      __self: this\n    }), __jsx(Info, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 370\n      },\n      __self: this\n    }, __jsx(Login, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 371\n      },\n      __self: this\n    }, __jsx(Link, {\n      href: user.url,\n      target: \"_blank\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 372\n      },\n      __self: this\n    }, user.login), __jsx(Name, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 378\n      },\n      __self: this\n    }, user.name)), __jsx(Status, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 380\n      },\n      __self: this\n    }, user.bio), __jsx(Icons, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 381\n      },\n      __self: this\n    }, __jsx(LocationIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 382\n      },\n      __self: this\n    }, __jsx(FontAwesomeIcon, {\n      size: \"xs\",\n      icon: faMapMarkerAlt,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 383\n      },\n      __self: this\n    })), __jsx(Location, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 388\n      },\n      __self: this\n    }, user.location), user.email !== '' ? __jsx(React.Fragment, null, __jsx(MailIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 391\n      },\n      __self: this\n    }, __jsx(FontAwesomeIcon, {\n      icon: faEnvelope,\n      size: \"xs\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 392\n      },\n      __self: this\n    })), __jsx(MailAdress, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 397\n      },\n      __self: this\n    }, user.email)) : null, __jsx(StarIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 402\n      },\n      __self: this\n    }, __jsx(FontAwesomeIcon, {\n      icon: faStar,\n      size: \"xs\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 403\n      },\n      __self: this\n    })), __jsx(Stars, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 408\n      },\n      __self: this\n    }, this.props.sum[data.indexOf(user)] === undefined ? ' ' : Number(this.props.sum[data.indexOf(user)]).toLocaleString())))), __jsx(Divider, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 422\n      },\n      __self: this\n    })))) // )\n    ); // Render real UI ...\n    // }\n  }\n\n}\n\nconst UsersWithSumState = connect(sumStateToProps, null)(ConnectedUsers);\nconst UsersWithDataState = connect(dataStateToProps, null)(UsersWithSumState);\nconst UsersWithSumDispatched = connect(null, sumDispatchToProps)(UsersWithDataState);\nconst Users = connect(null, dataDispatchToProps)(UsersWithSumDispatched);\nexport default Users;","map":{"version":3,"sources":["/home/ann/Development/Projects/Work/agile-nix-test/front/components/Users.js"],"names":["React","FontAwesomeIcon","faMapMarkerAlt","faEnvelope","faStar","faSpinner","styled","css","axios","connect","addSum","addData","sumStateToProps","state","sum","dataStateToProps","data","sumDispatchToProps","dispatch","dataDispatchToProps","axiosGitHubGraphQL","create","baseURL","headers","Authorization","GET_RATE","Divider","hr","Avatar","img","Info","div","Login","Status","Link","a","Name","p","Icons","LocationIcon","MailIcon","StarIcon","Stars","Location","MailAdress","Block","Loading","ConnectedUsers","Component","constructor","props","login","after","user","number","endCursor","that","toString","key","post","query","GET_SUM_HUNDRED","then","result","array","search","nodes","repositories","getSumHundred","GET_SUM_FIRST_HUNDRED","getSumFirstHundred","i","push","avatarUrl","bio","email","location","name","url","totalCount","onFetchSumForFirstHundredFromGitHub","getSum","topRepositories","edges","catch","error","alert","bind","componentDidMount","onFetchFromGitHub","summ","forEach","element","stargazers","pageInfo","hasNextPage","onFetchSumHundredFromGitHub","undefined","node","render","console","log","map","indexOf","Number","toLocaleString","UsersWithSumState","UsersWithDataState","UsersWithSumDispatched","Users"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n    faMapMarkerAlt,\n    faEnvelope,\n    faStar,\n    faSpinner\n} from '@fortawesome/free-solid-svg-icons';\nimport styled, { css } from 'styled-components';\nimport axios from 'axios';\nimport { connect } from 'react-redux';\nimport { addSum, addData } from '../redux/actions/index';\n\nconst sumStateToProps = state => {\n    return { sum: state.sum };\n};\n\nconst dataStateToProps = state => {\n    return { data: state.data };\n};\n\nfunction sumDispatchToProps(dispatch) {\n    return {\n        addSum: sum => dispatch(addSum(sum))\n    };\n}\n\nfunction dataDispatchToProps(dispatch) {\n    return {\n        addData: data => dispatch(addData(data))\n    };\n}\n\nconst axiosGitHubGraphQL = axios.create({\n    baseURL: 'https://api.github.com/graphql',\n    headers: {\n        Authorization: 'bearer 2cdc2aa829e6a0fe455edaf962cdda54e923b505'\n    }\n});\n\nconst GET_RATE = `\n{\n    search(   \n      type: USER, query:\"location:Kharkiv sort:followers-desc\"\n      first: 10) {\n      nodes {\n        ... on User {\n          name\n          login\n          avatarUrl\n          url\n          bio\n          location\n          email\n          repositories{totalCount}\n          topRepositories(first: 100, orderBy:{field: STARGAZERS, direction: DESC}) {\n            edges {\n              node {\n                stargazers{totalCount}\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n`;\nconst Divider = styled.hr`\n    background: rgba(128, 128, 128, 0.5);\n    width: 700px;\n    margin-left: auto;\n    margin-right: auto;\n    height: 1px;\n    border: 0;\n`;\nconst Avatar = styled.img`\n    width: 75px;\n    margin-top: 10px;\n    border-radius: 10px;\n    margin-bottom: 10px;\n`;\n\nconst Info = styled.div`\n    display: flex;\n    width: 88%;\n    flex-flow: column;\n    margin-top: 10px;\n`;\n\nconst Login = styled.div`\n    width: 88%;\n    display: flex;\n`;\n\nconst Status = styled.div`\n    margin-top: 10px;\n    padding-left: 10px;\n`;\n\nconst Link = styled.a`\n    text-decoration: blink;\n    padding-left: 10px;\n    color: #2664d9;\n`;\n\nconst Name = styled.p`\n    padding-left: 10px;\n    margin: 0;\n`;\n\nconst Icons = styled.div`\n    display: flex;\n    margin-top: 10px;\n    color: #858585;\n`;\n\nconst LocationIcon = styled.div`\n    padding-left: 10px;\n`;\n\nconst MailIcon = styled.div`\n    padding-left: 40px;\n`;\n\nconst StarIcon = styled.div`\n    padding-left: 40px;\n`;\n\nconst Stars = styled.div`\n    padding-left: 10px;\n`;\n\nconst Location = styled.div`\n    padding-left: 10px;\n`;\n\nconst MailAdress = styled.div`\n    padding-left: 10px;\n`;\n\nconst Block = styled.div`\n    width: 700px;\n    margin-left: auto;\n    margin-right: auto;\n    display: flex;\n`;\n\nconst Loading = styled.div`\n    display: flex;\n    align-items: center;\n    height: 100vh;\n    justify-content: center;\n`;\n\nclass ConnectedUsers extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            // externalData: null\n            // sum: {},\n            // data: []\n        };\n        this.getSum = this.getSum.bind(this);\n    }\n\n    // componentWillMount() {\n    //     this._asyncRequest = this.onFetchFromGitHub().then(externalData => {\n    //         this._asyncRequest = null;\n    //         this.setState({ externalData });\n    //     });\n    // }\n\n    componentDidMount() {\n        this.onFetchFromGitHub();\n    }\n\n    GET_SUM_FIRST_HUNDRED = login => `query \n{\n  search(   \n    type: USER, query:\"user:${login}\"\n    first: 1) {\n    nodes {\n      ... on User {\n        login\n        repositories (first:100) {\n      pageInfo {\n        hasNextPage,\n        endCursor\n      },\n      nodes {\n        stargazers{totalCount}\n      }\n      }\n    }\n  }\n}\n}`;\n\n    GET_SUM_HUNDRED = (login, after) =>\n        `query \n{\n  search(   \n    type: USER, query:\"user:${login}\"\n    first: 1) {\n    nodes {\n      ... on User {\n        login\n        repositories (first:100, after:\"${after}\") {\n      pageInfo {\n        hasNextPage,\n        endCursor\n      },\n      nodes {\n        stargazers{totalCount}\n      }\n      }\n    }\n  }\n}\n}`;\n\n    onFetchSumHundredFromGitHub = (user, number, endCursor) => {\n        const that = this;\n        const after = endCursor.toString();\n        const login = user;\n        const key = number;\n        axiosGitHubGraphQL\n            .post('', { query: that.GET_SUM_HUNDRED(login, after) })\n            .then(result => {\n                let array = result.data.data.search.nodes[0].repositories;\n                that.getSumHundred(array, key);\n            });\n    };\n\n    onFetchSumForFirstHundredFromGitHub = (user, number) => {\n        const that = this;\n        const login = user;\n        const key = number;\n        axiosGitHubGraphQL\n            .post('', { query: that.GET_SUM_FIRST_HUNDRED(login) })\n            .then(result => {\n                let array = result.data.data.search.nodes[0].repositories;\n                that.getSumFirstHundred(array, key, login);\n            });\n    };\n\n    onFetchFromGitHub = () => {\n        const that = this;\n        const { data } = this.props;\n        axiosGitHubGraphQL\n            .post('', { query: GET_RATE })\n            .then(result => {\n                let array = result.data.data.search.nodes;\n                for (var i = 0; i < 10; i++) {\n                    data.push({\n                        avatarUrl: array[i].avatarUrl,\n                        bio: array[i].bio,\n                        email: array[i].email,\n                        location: array[i].location,\n                        login: array[i].login,\n                        name: array[i].name,\n                        url: array[i].url\n                    });\n                    this.props.addData({ data: data });\n                    // that.setState({ data: data });\n                    if (array[i].repositories.totalCount > 100) {\n                        that.onFetchSumForFirstHundredFromGitHub(\n                            array[i].login,\n                            i\n                        );\n                    } else {\n                        that.getSum(array[i].topRepositories.edges, i);\n                    }\n                }\n            })\n            .catch(function(error) {\n                alert(error);\n            });\n    };\n\n    getSumHundred(array, number, name) {\n        let key = number;\n        let summ = 0;\n        const login = name;\n        const { sum } = this.props;\n        array.nodes.forEach(element => {\n            summ += element.stargazers.totalCount;\n        });\n        this.props.addSum({\n            sum: Object.assign(sum, {\n                [key]: summ + sum[key]\n            })\n        });\n        // this.setState({\n        //     sum: Object.assign(this.state.sum, {\n        //         [key]: sum + this.state.sum[key]\n        //     })\n        // });\n    }\n\n    getSumFirstHundred(array, number, name) {\n        let key = number;\n        let summ = 0;\n        const { sum } = this.props;\n        const login = name;\n        array.nodes.forEach(element => {\n            summ += element.stargazers.totalCount;\n        });\n        this.props.addSum({\n            sum: Object.assign(sum, {\n                [key]: summ\n            })\n        });\n        // this.setState({ sum: Object.assign(this.state.sum, { [key]: sum }) });\n        if (array.pageInfo.hasNextPage === true) {\n            this.onFetchSumHundredFromGitHub(\n                login,\n                key,\n                array.pageInfo.endCursor\n            );\n        }\n    }\n\n    getSum(array, number) {\n        let key = number;\n        let summ = 0;\n        const { sum } = this.props;\n\n        if (array !== undefined) {\n            array.forEach(element => {\n                summ += element.node.stargazers.totalCount;\n            });\n        }\n        this.props.addSum({\n            sum: Object.assign(sum, {\n                [key]: summ\n            })\n        });\n        // this.setState({ sum: Object.assign(this.state.sum, { [key]: sum }) });\n    }\n\n    render() {\n        // if (this.state.externalData === null) {\n        //     // Render loading state ...\n        //     console.log(0);\n        // } else {\n        const { data, sum } = this.props;\n        console.log(data);\n        return (\n            <>\n                {\n                    // data.length === 0\n                    // false ? (\n                    //     <Loading>\n                    //         <FontAwesomeIcon\n                    //             icon={faSpinner}\n                    //             size=\"4x\"\n                    //             spin\n                    //             pulse\n                    //         />\n                    //     </Loading>\n                    // ) : (\n                    <>\n                        <Divider />\n\n                        {data.map(user => (\n                            <>\n                                <Block>\n                                    <Avatar src={user.avatarUrl}></Avatar>\n                                    <Info>\n                                        <Login>\n                                            <Link\n                                                href={user.url}\n                                                target=\"_blank\"\n                                            >\n                                                {user.login}\n                                            </Link>\n                                            <Name>{user.name}</Name>\n                                        </Login>\n                                        <Status>{user.bio}</Status>\n                                        <Icons>\n                                            <LocationIcon>\n                                                <FontAwesomeIcon\n                                                    size=\"xs\"\n                                                    icon={faMapMarkerAlt}\n                                                ></FontAwesomeIcon>\n                                            </LocationIcon>\n                                            <Location>{user.location}</Location>\n                                            {user.email !== '' ? (\n                                                <>\n                                                    <MailIcon>\n                                                        <FontAwesomeIcon\n                                                            icon={faEnvelope}\n                                                            size=\"xs\"\n                                                        ></FontAwesomeIcon>\n                                                    </MailIcon>\n                                                    <MailAdress>\n                                                        {user.email}\n                                                    </MailAdress>\n                                                </>\n                                            ) : null}\n                                            <StarIcon>\n                                                <FontAwesomeIcon\n                                                    icon={faStar}\n                                                    size=\"xs\"\n                                                ></FontAwesomeIcon>\n                                            </StarIcon>\n                                            <Stars>\n                                                {this.props.sum[\n                                                    data.indexOf(user)\n                                                ] === undefined\n                                                    ? ' '\n                                                    : Number(\n                                                          this.props.sum[\n                                                              data.indexOf(user)\n                                                          ]\n                                                      ).toLocaleString()}\n                                            </Stars>\n                                        </Icons>\n                                    </Info>\n                                </Block>\n                                <Divider />\n                            </>\n                        ))}\n                    </>\n                    // )\n                }\n            </>\n        );\n        // Render real UI ...\n        // }\n    }\n}\n\nconst UsersWithSumState = connect(\n    sumStateToProps,\n    null\n)(ConnectedUsers);\n\nconst UsersWithDataState = connect(\n    dataStateToProps,\n    null\n)(UsersWithSumState);\n\nconst UsersWithSumDispatched = connect(\n    null,\n    sumDispatchToProps\n)(UsersWithDataState);\n\nconst Users = connect(\n    null,\n    dataDispatchToProps\n)(UsersWithSumDispatched);\n\nexport default Users;\n"]},"metadata":{},"sourceType":"module"}